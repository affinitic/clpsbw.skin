<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

<head>
    <script src="validate_forms.js" type="text/javascript"></script>
    <metal:noborder fill-slot="top_slot"
                    tal:define="dummy python:request.set('disable_border',1)" />
</head>

<body>
<div metal:fill-slot="main"
     tal:define="ressourcePk request/ressourcePk | nothing;
                 ressources python:view.getRessourceByPk(ressourcePk);
                 publics python:view.getPublicByRessourcePk(ressourcePk, 'nom');
                 supports python:view.getSupportByRessourcePk(ressourcePk, 'titre');
                 clpsDispo python:view.getClpsDispoByRessourcePk(ressourcePk, 'titre');
                 allClps python: view.getAllClps();
                 selectedClpsProprio python:view.getClpsProprioForRessource(ressourcePk, 'pk')">
    <tal:boucle tal:repeat="ressource ressources">
        <tal:block tal:define="ressourcePk ressource/ressource_pk">
            <div id="title-ressource">
                <div id="title-ressource-left"></div>
                <div class="titre-ressource-top">
                    <p><span tal:content="ressource/ressource_titre" /></p>
                </div>
                <div id="title-ressource-right"
                      tal:define="ressourcePk ressource/ressource_pk">
                    <div class="btn-modifier"
                         tal:condition="python:user.has_role(['Manager'], here)">
                        <br />
                        <a href=""
                           tal:attributes="href string: ressource-modifier?ressourcePk=${ressourcePk}">&nbsp;</a>
                    </div>
                </div>
            </div>


            <div id="left-ressource">
                <div class="puzzle-vert">
                    <span class="left-rubrique-db">Public</span>
                    <div class="text-db">
                        <tal:boucle tal:repeat="public publics">
                            <span tal:content="public"
                                  class="rubrique-db">public</span><br />
                        </tal:boucle>
                    </div>
                    <div tal:condition="python: ressource.ressource_autre_info != ''"
                         class="text-db">
                        <span tal:content="ressource/ressource_autre_info"
                              class="rubrique-db" />
                    </div>
                </div>

                <div class="puzzle-rouge"
                     tal:condition="python: ressource.ressource_objectif!=''">
                    <span class="left-rubrique-db">Objectif(s)</span>
                    <div class="text-db">
                        <span tal:replace="structure ressource/ressource_objectif"></span>
                    </div>
                </div>

                <div class="puzzle-vert"
                     tal:condition="python: ressource.ressource_description!=''">
                    <span class="left-rubrique-db">Description</span>
                    <div class="text-db">
                        <span tal:replace="structure ressource/ressource_description" />
                    </div>
                </div>

                <div class="puzzle-jaune"
                     tal:condition="python: ressource.ressource_utilisation!=''">
                    <span class="left-rubrique-db">Utilisation</span>
                    <div class="text-db">
                        <span tal:replace="structure ressource/ressource_utilisation" />
                    </div>
                </div>

                <div class="puzzle-rouge"
                     tal:condition="python: ressource.ressource_avis_clps!=''">
                    <span class="left-rubrique-db">Avis du CLPS</span>
                    <div class="text-db">
                        <span tal:replace="structure ressource/ressource_avis_clps" />
                    </div>
                </div>
                <div class="puzzle-vert"
                     tal:condition="python: ressource.ressource_lien_pipsa!=''">
                    <span class="left-rubrique-db">Lien pipsa</span>
                    <br />
                    <a href=""
                       target="_blank"
                       tal:attributes="href ressource/ressource_lien_pipsa">
                        <span tal:content="ressource/ressource_lien_pipsa" /></a>
                </div>

                <div class="puzzle-gris"
                     tal:condition="python: ressource.ressource_autre_lien!=''">
                    <span class="left-rubrique-db">Autre lien</span>
                    <br />
                    <a href=""
                       target="_blank"
                       tal:attributes="href ressource/ressource_autre_lien">
                    <span tal:content="ressource/ressource_autre_lien" /></a>
                </div>
            </div><!--left-->



            <div id="right-ressource">
                <div id="right-ressource-header"></div>
                <div id="right-ressource-content">
                    <div tal:condition="python: ressource.ressource_auteur!=''">
                        <span class="right-rubrique-db">Auteur(s)</span>
                        <br />
                        &#8226;
                        <span tal:content="ressource/ressource_auteur" />
                    </div>

                    <div tal:condition="python: ressource.ressource_edition!=''">
                        <span class="right-rubrique-db">Editeur</span>
                        <br />
                        &#8226;
                        <span tal:content="ressource/ressource_edition" />
                    </div>

                    <div tal:condition="python: ressource.ressource_lieu_edition!=''">
                        <span class="right-rubrique-db">Lieu d'édition</span>
                        <br />
                        &#8226;
                        <span tal:content="ressource/ressource_lieu_edition" />
                    </div>

                    <div tal:condition="python: ressource.ressource_date_edition!=''">
                        <span class="right-rubrique-db">Date d'édition</span>
                        <br />
                        &#8226;
                        <span tal:content="ressource/ressource_date_edition" />
                    </div>

                    <div tal:condition="python: ressource.ressource_collection!=''">
                        <span class="right-rubrique-db">Collection</span>
                        <br />
                        &#8226;
                        <span tal:content="ressource/ressource_collection" />
                    </div>

                    <div tal:condition="clpsDispo">
                        <span class="right-rubrique-db">Disponibilité</span>
                        <br />
                        <tal:boucle tal:repeat="clps clpsDispo">
                            &#8226;
                            <span tal:content="clps">clps ou est disponible la ressource</span><br />
                        </tal:boucle>
                    </div>

                    <div tal:condition="python: ressource.ressource_disponible_autre!=''">
                        <span class="right-rubrique-db">Autre disponibilité</span>
                        <br />
                        &#8226;
                        <span tal:content="ressource/ressource_disponible_autre" />
                    </div>

                    <div tal:condition="supports">
                        <span class="right-rubrique-db">Support</span>
                        <br />
                        <tal:boucle tal:repeat="support supports">
                            <span tal:content="support"
                                  class="rubrique-db">support</span><br />
                        </tal:boucle>
                    </div>
                </div><!--content-->
                <div id="right-ressource-footer"></div>

                <tal:block tal:define="experiences python:view.getExperienceByRessource(ressource.ressource_pk)">
                    <div tal:condition="python: len(experiences) > 0"
                         id="projet-partage-ressource">
                        <h3><img src="projet_partage_logo_cercle.png" /> Projets partagés</h3>
                        <tal:boucle tal:repeat="experience experiences">
                            <p>
                            &#8226;
                            <a href=""
                               tal:attributes="href string:${context/portal_url}/experience-decrire?experiencePk=${experience/experience_pk}">
                                <span tal:content="experience/experience_titre"></span></a>
                            </p>
                        </tal:boucle>
                    </div>
                </tal:block>
                <div id="pdf-ressource">
                    <a href=""
                       tal:attributes="href string:${context/portal_url}/getPdf?ressourcePk=${ressourcePk}">
                        <span class="right-rubrique-db">Télécharger la fiche en PDF</span>
                        <img src="logo_pdf.png"
                             width="18" /></a>
                </div>
            </div><!--right-->

            <div id="clearboth"></div>


<!--gestion admin-->
            <div tal:condition="python:user.has_role(['Manager'], here)"
                 class="description-for-manager">
                <div class="titre-for-manage">
                    &Xi; Administration &Xi;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <span tal:content="ressource/ressource_pk" />
                </div>

                <fieldset>
                    <legend class="legende"> Lien pour la newsletter</legend>
                    <span tal:content="string:${context/portal_url}/ressource-decrire?ressourcePk=${ressource/ressource_pk}" />
                </fieldset>

                <fieldset>
                    <legend class="legende"> Etat </legend>
                    <span tal:condition="python:ressource.ressource_etat=='private'">
                        <span class="grasrouge">Privé</span>
                    </span>
                    <span tal:condition="python:ressource.ressource_etat=='publish'">
                        <span class="grasvert">Publié</span>
                    </span>
                </fieldset>

                <fieldset>
                    <legend>Thème</legend>
                    <tal:block tal:define="themes python:view.getThemeNomByRessourcePk(ressource.ressource_pk)">
                        <tal:boucle tal:repeat="theme themes">
                            <span tal:content="theme"
                                  class="rubrique-db">theme</span><br />
                        </tal:boucle>
                    </tal:block>
                </fieldset>
                <fieldset>
                    <legend>Plate-forme</legend>
                    <ul class="formulaire">
                        <li>
                            <img src="label_flch_rouge.png" />
                            <input type="checkbox"
                                   name="ressource_plate_forme_sante_ecole"
                                   value="True"
                                   tal:attributes="checked python:ressource.ressource_plate_forme_sante_ecole and 'checked' or None;" />
                            &nbsp;&nbsp;Santé à l'école
                        </li>
                        <li>
                            <img src="label_flch_rouge.png" />
                            <input type="checkbox"
                                   name="ressource_plate_forme_assuetude"
                                   value="True"
                                   tal:attributes="checked python:ressource.ressource_plate_forme_assuetude and 'checked' or None;" />
                            &nbsp;&nbsp;Point d'appui assuétudes
                        </li>
                        <li>
                            <img src="label_flch_rouge.png" />
                            <input type="checkbox"
                                   name="ressource_plate_forme_sante_famille"
                                   value="True"
                                   tal:attributes="checked python:ressource.ressource_plate_forme_sante_famille and 'checked' or None;" />
                            &nbsp;&nbsp;Santé des familles
                        </li>
                        <li>
                            <img src="label_flch_rouge.png" />
                            <input type="checkbox"
                                   name="ressource_plate_forme_sante_environnement"
                                   value="True"
                                   tal:attributes="checked python:ressource.ressource_plate_forme_sante_environnement and 'checked' or None;" />
                            &nbsp;&nbsp;Santé - environnement
                        </li>
                    </ul>
                </fieldset>

                <fieldset>
                    <legend>Mission</legend>
                    <ul class="formulaire">
                        <li>
                            <img src="label_flch_rouge.png" />
                            <input type="checkbox"
                                   name="ressource_mission_centre_documentation"
                                   value="True"
                                   tal:attributes="checked python:ressource.ressource_mission_centre_documentation and 'checked' or None;" />
                            &nbsp;&nbsp;Centre documentation
                        </li>
                        <li>
                            <img src="label_flch_rouge.png" />
                            <input type="checkbox"
                                   name="ressource_mission_accompagnement_projet"
                                   value="True"
                                   tal:attributes="checked python:ressource.ressource_mission_accompagnement_projet and 'checked' or None;" />
                            &nbsp;&nbsp;Accompagnement de projet
                        </li>
                        <li>
                            <img src="label_flch_rouge.png" />
                            <input type="checkbox"
                                   name="ressource_mission_reseau_echange"
                                   value="True"
                                   tal:attributes="checked python:ressource.ressource_mission_reseau_echange and 'checked' or None;" />
                            &nbsp;&nbsp;Mise en réseau, échanges
                        </li>
                        <li>
                            <img src="label_flch_rouge.png" />
                            <input type="checkbox"
                                   name="ressource_mission_formation"
                                   value="True"
                                   tal:attributes="checked python:ressource.ressource_mission_formation and 'checked' or None;" />
                             &nbsp;&nbsp;Formation
                        </li>
                    </ul>
                </fieldset>
                <fieldset>
                    <legend>Propriétaire</legend>
                    <ul class="formulaire">
                        <tal:boucle tal:repeat="clps allClps">
                            <li>
                              <img src="label_flch_rouge.png" />
                              <input type="checkbox"
                                 name="ressource_clps_fk:list"
                                 checked=""
                                 value=""
                                 tal:attributes="value clps/clps_pk;
                                                 checked python:clps.clps_pk in selectedClpsProprio and 'selected' or None;" />
                              &nbsp;&nbsp;
                              <span tal:content="clps/clps_nom" />
                            </li>
                        </tal:boucle>
                    </ul>
                </fieldset>

            </div>
            <hr />
        </tal:block>
    </tal:boucle>
</div><!-- div metal-->
</body>
</html>
